# AI 职业规划小程序
<img width="306" height="661" alt="image" src="https://github.com/user-attachments/assets/ca5b9b72-7cec-4935-981b-63b3dd8b40d1" /><img width="318" height="665" alt="image" src="https://github.com/user-attachments/assets/4248a918-4bdd-484b-a02d-4286346b2d85" /><img width="307" height="662" alt="image" src="https://github.com/user-attachments/assets/69c2178d-18e2-47cc-93f4-e622e7de0a3b" /><img width="318" height="667" alt="image" src="https://github.com/user-attachments/assets/9ccc20e3-8016-4f06-8972-d1a7c314534c" />![Uploading image.png…]()





## 1. 项目简介

本小程序旨在利用 AI 技术，为大学生和初入职场的用户提供一站式、个性化的职业规划与求职辅导服务。我们通过科学的职业测评、智能的简历优化、逼真的模拟面试以及清晰的职业路径图，帮助用户更好地认识自我、明确方向、提升求职竞争力。

## 2. 技术栈

- **前端：** 微信小程序原生 (WXML, WXSS, JavaScript)
- **后端：** 微信云开发
  - **云函数 (Cloud Functions):** 用于处理核心业务逻辑，如与 AI 接口交互、数据分析等。
  - **云数据库 (Cloud Database):** 用于存储用户信息、测评结果、简历数据等。
  - **云存储 (Cloud Storage):** 用于存储用户上传的简历文件或其他资料。

## 3. 核心功能模块

### 开发状态跟踪

| 功能模块 | 模块标识 (ID) | 页面路径 | 负责人 | 开发状态 | 备注 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **职业测评** | `assessment` | `pages/assessment/` | - | `已对接后端` | 答题与结果生成已联调真实 AI 服务。 |
| **AI 简历优化** | `resume` | `pages/resume/` | - | `开发中` | 支持模板填写和PDF上传两种方式，AI诊断与保存独立。 |
| **AI 模拟面试** | `interview` | `pages/interview/` | - | `已完成` | 完整面试流程，支持多轮对话、AI评分、结果分析。 |
| **职业技能图谱** | `map` | `pages/map/` | - | `已完成` | 5个职业方向的技能树可视化，支持职业切换和节点交互。 |
| **AI 问答助手** | `assistant` | `pages/assistant/` | - | `已对接后端` | 已接入 Qwen 模型，支持真实多轮对话。 |

## 4. 项目结构

```
.
├── cloudfunctions/         # 云函数目录
│   ├── analyzeAssessment/  # 测评分析 (Qwen)
│   └── chatAssistant/      # AI 问答助手 (Qwen) [新增]
├── miniprogram/            # 小程序前端代码
│   ├── pages/              # 页面文件
│   │   ├── assessment/     # 职业测评
│   │   ├── assistant/      # AI 助手
│   │   ├── interview/      # 模拟面试
│   │   ├── map/            # 职业地图
│   │   └── resume/         # 简历优化
│   ├── components/         # 自定义组件
│   ├── utils/              # 工具函数
│   ├── images/             # 静态图片资源
│   ├── app.js
│   ├── app.json
│   └── app.wxss
├── project.config.json     # 项目配置文件
└── README.md               # 项目文档
```

## 5. 技术实现细节

*本章节将在开发过程中持续更新，记录各模块的关键实现逻辑、API 对接方案等。*

### 职业测评模块 (assessment)
- **首页逻辑 (`pages/assessment/index`)**:
    - 已接入云数据库 `assessment_tasks` 集合，动态获取任务列表。
    - 实现了任务状态 (`active`/`locked`) 的判断与交互控制。
    - 在 `app.js` 中配置了云环境 ID: `cloud1-3g8bn62od8f831f1`。
- **流程实现**:
    - 实现了从 介绍页 -> 答题页 -> 结果页 的完整页面跳转链路。
    - **[UI] 2025-11-24 更新**: 调整了测评首页 (`pages/assessment/index`) 样式以匹配高保真设计稿。
    - **[后端对接] 2025-11-25 更新**:
        - **答题页 (`quiz`)**: 
            - 实现了从云数据库 `assessment_questions` 动态拉取题目。
            - 优化了答题交互：选中高亮、自动跳转下一题（延迟 300ms）、进度条平滑过渡。
            - 提交时调用云函数 `analyzeAssessment` 获取 AI 分析结果，并使用 `wx.redirectTo` 避免重复提交和返回。
        - **结果页 (`result`)**: 
            - 实现了通过 `resultId` 从云数据库 `assessment_results` 获取报告数据。
            - 数据映射：将 AI 返回的 MBTI、雷达图数据、职业推荐匹配度（随机生成 85%-98%）、分析建议等映射到前端 UI。

### AI 问答助手 (assistant)
- **功能实现**:
    - 新增云函数 `chatAssistant`，复用 DashScope API Key。
    - 前端 `pages/assistant/index.js` 实现多轮对话逻辑，支持上下文携带 (最近6条)。
    - 交互优化：添加 "AI 正在思考中..." 状态反馈。

### AI 简历优化模块 (resume)
- **[2025-11-25 更新] 重新设计简历功能流程**:
    - **双轨创建方式**:
        - 模板填写：提供标准化简历模板，包含个人信息、求职意向、教育背景、工作经验、荣誉证书、语言能力、自我评价、兴趣爱好等完整字段
        - PDF上传：支持用户上传已有PDF简历，文件大小限制10MB，自动上传到云存储
    - **解耦保存与诊断**:
        - 用户可以单独保存简历，无需强制进行AI诊断
        - AI诊断作为独立功能，用户可自主选择诊断时机
        - 已诊断简历支持重新诊断功能
    - **优化预览功能**:
        - 模板简历：按照标准简历格式展示，美观专业
        - PDF简历：使用微信小程序原生API打开文档预览
        - 添加返回按钮和编辑功能，防止用户迷失
    - **数据结构**:
        - 数据库存储结构化简历数据（`resumeData`）和文本内容（`content`）
        - 支持简历类型标识（`template`/`pdf`/`text`）
        - PDF文件存储在云存储，数据库记录文件ID

### 职业技能图谱模块 (map)
- **[2025-11-26 新增] 完成职业地图可视化功能**:
    - **核心功能**:
        - 5个职业方向：前端开发、后端开发、产品经理、UI设计、运营
        - 炫酷的技能树动画：中心核心呼吸效果、节点悬浮动画、发散射线
        - 职业切换选择器：顶部 picker 组件快速切换
        - 节点交互：已解锁节点可点击查看详情，未解锁显示"?"
    - **数据驱动**:
        - 从云数据库 `career_paths` 动态加载数据
        - 每个职业包含：名称、图标、等级、经验、技能分支、下一阶段目标
        - 技能分支包含：名称、emoji、角度、距离、解锁状态、描述
    - **UI/UX**:
        - 深色背景的技能树卡片，视觉效果震撼
        - 已解锁节点：蓝色边框 + 名称标签
        - 未解锁节点：灰色边框 + "?" 符号 + 虚线连接
        - 点击已解锁节点弹出详情弹窗
    - **技术实现**:
        - 使用 `wx:for` 动态渲染技能树节点
        - 通过 CSS 变量控制节点位置（角度和距离）
        - Loading 状态处理和错误提示

---

## 6. 代码检查与问题记录

*本章节用于记录代码审查中发现的问题、待优化的点以及 Bug 修复日志。*

### 2025-11-26 职业地图模块开发
- **[新增] 核心功能**: 实现了5个职业方向的技能树可视化
- **[新增] 数据驱动**: 从云数据库动态加载职业数据
- **[新增] 交互体验**: 职业切换、节点点击、详情弹窗
- **[优化] 视觉效果**: 保留原有炫酷动画，添加动态渲染
- **[文档] 部署指南**: 创建 MAP_FEATURE_README.md 详细部署说明

### 2025-11-25 简历模块重构
- **[重构] 创建流程**: 改为双轨方式（模板填写/PDF上传），提升用户自由度
- **[优化] 保存逻辑**: 保存和AI诊断解耦，用户可独立选择
- **[优化] 预览功能**: 重新设计预览页面，添加返回按钮，支持模板格式展示
- **[新增] PDF支持**: 支持PDF简历上传和预览功能
- **[优化] 表单设计**: 按照标准简历模板设计完整表单，包含13个主要字段类别

### 2025-11-25 AI 助手接入
- **[新增] 云函数**: 创建了 `chatAssistant`，使用 `openai` SDK 调用通义千问 (Qwen) 模型。
- **[前端] 交互**: 替换了原有的 Mock `setTimeout` 逻辑，实现了真实的 `wx.cloud.callFunction` 调用。

### 2025-11-25 职业测评模块优化 (已归档)
- **[已修复] 题目数据硬编码**: 已改为从云数据库 (`assessment_questions`) 动态拉取。
- **[已修复] 结果生成模拟**: 已对接真实云函数 `analyzeAssessment`。
- **[优化] 提交体验**: 增加了 "AI 正在进行性格分析..." 的 Loading 提示，并增加了防止重复提交的逻辑。
