# 简历功能部署操作清单

## ✅ 已完成的开发工作

### 1. 云函数
- ✅ 创建了 `cloudfunctions/analyzeResume/` 云函数
- ✅ 配置了通义千问 API（qwen-plus 模型）
- ✅ 实现了简历 AI 分析功能

### 2. 页面开发
- ✅ 创建了诊断结果页 `pages/resume/diagnosis/index`
- ✅ 修改了简历编辑页支持保存到云数据库
- ✅ 修改了简历中心页从数据库动态加载数据
- ✅ 注册了新页面到 `app.json`

### 3. 数据流程
- ✅ 用户创建/编辑简历 → 保存到云数据库
- ✅ 点击 AI 诊断 → 调用云函数分析
- ✅ 显示完整报告和结构化建议
- ✅ 简历中心动态显示优化建议

---

## ⚠️ 需要您手动操作的步骤

### 步骤 1：创建云数据库集合（必须）

1. 打开微信开发者工具
2. 点击顶部菜单 "云开发" → 进入控制台
3. 左侧选择 "数据库"
4. 点击 "添加集合"
5. 输入集合名称：`resumes`
6. 权限设置：选择 **"仅创建者可读写"**
7. 点击确定

**数据结构参考：** 详见 `cloudfunctions/DATABASE_SETUP.md`

---

### 步骤 2：部署云函数（必须）

**方式一：使用微信开发者工具**
1. 展开 `cloudfunctions/` 目录
2. 右键点击 `analyzeResume` 文件夹
3. 选择 **"上传并部署：云端安装依赖"**
4. 等待部署完成（大约 1-2 分钟）

**方式二：使用命令行脚本**
```bash
./uploadCloudFunction.sh analyzeResume  
```

---

### 步骤 3：重新编译小程序

1. 在微信开发者工具中点击 "编译" 按钮
2. 等待编译完成
3. 查看控制台确认没有报错

---

## 🧪 测试流程

### 1. 测试新建简历
- 点击简历中心的 "新建简历" 卡片
- 输入简历内容（或粘贴）
- 点击 "开始全维诊断"
- 应该跳转到诊断结果页，显示 AI 分析报告

### 2. 测试 AI 诊断
- 在诊断结果页查看：
  - ✅ 评分（0-100）
  - ✅ 等级（A/B/C/D）
  - ✅ 完整分析报告
  - ✅ 优化建议列表（3-5 条）

### 3. 测试简历中心
- 返回简历中心
- 应该能看到：
  - ✅ 简历评分卡片（显示最新简历的分数）
  - ✅ 我的简历列表（最多显示 3 个）
  - ✅ 优化建议列表（动态显示）

### 4. 测试优化建议
- 点击优化建议卡片
- 应该弹出 Modal 显示详细建议内容

---

## 🐛 常见问题排查

### 问题 1：云函数调用失败
**原因：** 云函数未部署或部署失败
**解决：** 重新执行步骤 2，检查云开发控制台的云函数列表

### 问题 2：数据库操作报错
**原因：** 未创建 `resumes` 集合
**解决：** 执行步骤 1 创建数据库集合

### 问题 3：AI 返回格式错误
**原因：** AI 返回的不是标准 JSON
**解决：** 云函数已有兜底逻辑，会返回默认建议

### 问题 4：页面跳转失败
**原因：** 新页面未注册
**解决：** 确认 `app.json` 中已包含 `pages/resume/diagnosis/index`

---

## 📝 功能说明

### 完整用户流程

```
1. 用户打开简历中心
   ↓
2. 点击"新建简历"
   ↓
3. 输入/粘贴简历内容
   ↓
4. 点击"开始全维诊断"
   ↓
5. 系统：
   - 保存简历到云数据库
   - 调用 AI 分析（通义千问）
   - 返回评分 + 报告 + 建议
   ↓
6. 跳转到诊断结果页
   - 显示完整 AI 报告
   - 显示结构化建议卡片
   ↓
7. 返回简历中心
   - 简历评分卡片自动更新
   - 优化建议列表自动更新
   ↓
8. 用户可以：
   - 点击优化建议查看详情
   - 点击"AI 诊断"重新分析
   - 编辑简历内容
   - 管理多份简历（重命名/复制/删除）
```

---

## 🚀 后续可扩展功能

- [ ] PDF 生成功能（预览 PDF 按钮）
- [ ] 简历模板选择
- [ ] 简历历史版本对比
- [ ] 导出 Word/PDF 格式
- [ ] 行业专项优化建议
- [ ] 简历得分趋势图表

---

## 📞 需要帮助？

如果遇到问题，请提供：
1. 控制台的完整报错信息
2. 操作的具体步骤
3. 当前看到的页面截图

我会立即协助您解决！

