<view class="container">
  <!-- Loading 状态 -->
  <view wx:if="{{isLoading}}" class="g-loading-box">
    <view class="g-loading-spinner"></view>
    <view class="loading-text">AI 正在生成分析报告...</view>
  </view>

  <block wx:else>
    <view class="result-page">
      <view class="result-header">
        <view class="back-btn-white" bindtap="goHome">←</view>
        <!-- 分享按钮 (新增) -->
        <view class="share-btn-white" bindtap="showShareModal">分享</view>

        <view class="header-content">
          <view class="score-ring">
            <text class="score-val">{{report.score}}</text>
            <text class="score-label">潜力指数</text>
          </view>
          <view class="result-title">{{report.type}}</view>
          <view class="result-desc">{{report.advice}}</view>
        </view>
        <!-- 背景装饰 -->
        <view class="bg-circle c1"></view>
        <view class="bg-circle c2"></view>
      </view>

      <view class="report-card">
        <view class="section-title">能力维度</view>
        
        <!-- 动态能力条形图 -->
        <view class="skill-bars">
          <block wx:for="{{report.dimensions}}" wx:key="name">
            <view class="skill-row">
              <text class="skill-name">{{item.name}}</text>
              <view class="bar-track">
                <view class="bar-fill" style="width: {{item.value}}%;"></view>
              </view>
              <text class="skill-val">{{item.value}}</text>
            </view>
          </block>
        </view>

        <view class="divider"></view>

        <view class="section-title">推荐职业</view>
        
        <block wx:for="{{report.careers}}" wx:key="title">
          <view class="job-card" bindtap="viewCareerDetail" data-index="{{index}}">
            <view class="job-icon">💼</view>
            <view class="job-info">
              <view class="job-name">{{item.title}}</view>
              <view class="job-salary">匹配度 {{item.match}}%</view>
            </view>
            <view class="job-arrow">→</view>
          </view>
        </block>

        <button class="btn-save" bindtap="goHome">返回测评首页</button>
      </view>
    </view>

    <!-- 分享海报弹窗 (Mock UI) -->
    <view class="modal-mask" wx:if="{{showShare}}" bindtap="hideShareModal">
      <view class="share-modal" catchtap="stopProp">
        <view class="poster-preview">
          <view class="poster-header">
            <view class="poster-title">我的职业基因</view>
            <view class="poster-type">{{report.type}}</view>
          </view>
          <view class="poster-radar-mock">
            <view class="radar-circle"></view>
            <text>AI 深度解析</text>
          </view>
          <view class="poster-footer">
            <view class="qr-mock"></view>
            <text class="qr-tip">长按识别测试</text>
          </view>
        </view>
        <button class="btn-save-image" bindtap="saveImageMock">保存到相册</button>
      </view>
    </view>
  </block>
</view>