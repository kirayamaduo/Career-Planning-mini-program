<view class="preview-page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="nav-header" style="padding-top: {{statusBarHeight}}px; height: {{navHeight}}px;">
    <view class="nav-back" bindtap="handleBack">
      <text class="back-icon">â®</text>
    </view>
    <view class="nav-title">ç®€å†é¢„è§ˆ</view>
    <view class="nav-right"></view>
  </view>

  <!-- é¢„è§ˆå†…å®¹åŒº -->
  <scroll-view scroll-y class="preview-content" style="margin-top: {{navHeight}}px;">
    <!-- æ¨¡æ¿ç±»å‹ç®€å† -->
    <view wx:if="{{resume && resume.type === 'template' && resume.resumeData}}" class="resume-template">
      <!-- ä¸ªäººä¿¡æ¯å¤´éƒ¨ -->
      <view class="resume-header">
        <view class="avatar-box">
          <image class="avatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed={{resume.resumeData.name}}"></image>
        </view>
        <view class="basic-info">
          <view class="name">{{resume.resumeData.name || 'æœªå¡«å†™'}}</view>
          <view class="info-row">
            <text class="info-item">{{resume.resumeData.age}}å²</text>
            <text class="divider">|</text>
            <text class="info-item">{{resume.resumeData.gender}}</text>
            <text class="divider">|</text>
            <text class="info-item">{{resume.resumeData.city}}</text>
          </view>
          <view class="contact-row">
            <text class="contact-item">ğŸ“± {{resume.resumeData.phone}}</text>
            <text class="contact-item">ğŸ“§ {{resume.resumeData.email}}</text>
          </view>
        </view>
      </view>

      <!-- æ±‚èŒæ„å‘ -->
      <view class="resume-section" wx:if="{{resume.resumeData.targetPosition}}">
        <view class="section-title">
          <view class="title-icon">ğŸ’¼</view>
          <text class="title-text">æ±‚èŒæ„å‘</text>
        </view>
        <view class="section-content">
          <view class="job-intention">
            <text class="label">æ„å‘å²—ä½ï¼š</text><text class="value">{{resume.resumeData.targetPosition}}</text>
          </view>
          <view class="job-intention">
            <text class="label">æ„å‘åŸå¸‚ï¼š</text><text class="value">{{resume.resumeData.targetCity}}</text>
          </view>
          <view class="job-intention">
            <text class="label">æœŸæœ›è–ªèµ„ï¼š</text><text class="value">{{resume.resumeData.expectedSalary}}</text>
          </view>
          <view class="job-intention">
            <text class="label">å…¥èŒæ—¶é—´ï¼š</text><text class="value">{{resume.resumeData.availableTime}}</text>
          </view>
        </view>
      </view>

      <!-- æ•™è‚²èƒŒæ™¯ -->
      <view class="resume-section" wx:if="{{resume.resumeData.education.length > 0}}">
        <view class="section-title">
          <view class="title-icon">ğŸ“</view>
          <text class="title-text">æ•™è‚²èƒŒæ™¯</text>
        </view>
        <view class="section-content">
          <view wx:for="{{resume.resumeData.education}}" wx:key="index" class="education-item" wx:if="{{item.school}}">
            <view class="time-line">
              <view class="time-dot"></view>
              <view class="time-text">{{item.timeRange}}</view>
            </view>
            <view class="edu-content">
              <view class="edu-title">{{item.school}}</view>
              <view class="edu-detail">{{item.major}} Â· {{item.degree}}</view>
              <view class="edu-detail" wx:if="{{item.gpa}}">GPA: {{item.gpa}} {{item.rank}}</view>
              <view class="edu-courses" wx:if="{{item.courses}}">ä¸»ä¿®è¯¾ç¨‹ï¼š{{item.courses}}</view>
            </view>
          </view>
        </view>
      </view>

      <!-- å·¥ä½œç»éªŒ -->
      <view class="resume-section" wx:if="{{resume.resumeData.workExperience.length > 0}}">
        <view class="section-title">
          <view class="title-icon">ğŸ’»</view>
          <text class="title-text">å·¥ä½œç»éªŒ</text>
        </view>
        <view class="section-content">
          <view wx:for="{{resume.resumeData.workExperience}}" wx:key="index" class="work-item" wx:if="{{item.company}}">
            <view class="time-line">
              <view class="time-dot"></view>
              <view class="time-text">{{item.timeRange}}</view>
            </view>
            <view class="work-content">
              <view class="work-title">{{item.company}}</view>
              <view class="work-position">{{item.position}}</view>
              <view class="work-responsibilities">
                <view wx:for="{{item.responsibilities}}" wx:key="rIndex" wx:for-item="resp" class="resp-item" wx:if="{{resp}}">
                  â€¢ {{resp}}
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- è£èª‰è¯ä¹¦ -->
      <view class="resume-section" wx:if="{{resume.resumeData.certificates.length > 0 && resume.resumeData.certificates[0]}}">
        <view class="section-title">
          <view class="title-icon">ğŸ†</view>
          <text class="title-text">è£èª‰è¯ä¹¦</text>
        </view>
        <view class="section-content">
          <view wx:for="{{resume.resumeData.certificates}}" wx:key="index" class="cert-item" wx:if="{{item}}">
            â€¢ {{item}}
          </view>
        </view>
      </view>

      <!-- è¯­è¨€èƒ½åŠ› -->
      <view class="resume-section" wx:if="{{resume.resumeData.skills.computer || resume.resumeData.skills.english}}">
        <view class="section-title">
          <view class="title-icon">ğŸ—£</view>
          <text class="title-text">è¯­è¨€èƒ½åŠ›</text>
        </view>
        <view class="section-content">
          <view class="skill-item" wx:if="{{resume.resumeData.skills.computer}}">
            <text class="skill-label">è®¡ç®—æœºï¼š</text>
            <text class="skill-text">{{resume.resumeData.skills.computer}}</text>
          </view>
          <view class="skill-item" wx:if="{{resume.resumeData.skills.english}}">
            <text class="skill-label">è‹±è¯­ï¼š</text>
            <text class="skill-text">{{resume.resumeData.skills.english}}</text>
          </view>
        </view>
      </view>

      <!-- è‡ªæˆ‘è¯„ä»· -->
      <view class="resume-section" wx:if="{{resume.resumeData.selfEvaluation}}">
        <view class="section-title">
          <view class="title-icon">ğŸ’¬</view>
          <text class="title-text">è‡ªæˆ‘è¯„ä»·</text>
        </view>
        <view class="section-content">
          <text class="self-eval">{{resume.resumeData.selfEvaluation}}</text>
        </view>
      </view>

      <!-- å…´è¶£çˆ±å¥½ -->
      <view class="resume-section" wx:if="{{resume.resumeData.hobbies.length > 0}}">
        <view class="section-title">
          <view class="title-icon">â¤ï¸</view>
          <text class="title-text">å…´è¶£çˆ±å¥½</text>
        </view>
        <view class="section-content">
          <view class="hobby-tags">
            <text wx:for="{{resume.resumeData.hobbies}}" wx:key="item" class="hobby-tag">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ–‡æœ¬ç±»å‹ç®€å†ï¼ˆå…¼å®¹æ—§ç‰ˆï¼‰ -->
    <view wx:elif="{{resume && resume.content}}" class="resume-text">
      <view class="text-header">
        <text class="text-title">{{resume.title}}</text>
      </view>
      <view class="text-content">
        <text class="content-text">{{resume.content}}</text>
      </view>
    </view>

    <!-- PDFç±»å‹æç¤º -->
    <view wx:elif="{{isPdf}}" class="pdf-hint">
      <view class="hint-icon">ğŸ“„</view>
      <text class="hint-text">PDFç®€å†å·²åœ¨å¤–éƒ¨æ‰“å¼€</text>
    </view>

    <view class="bottom-space"></view>
  </scroll-view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="action-bar">
    <button class="btn-edit" bindtap="handleEdit">ç¼–è¾‘</button>
  </view>
</view>
